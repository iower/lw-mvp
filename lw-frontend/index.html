<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HardWallet</title>
</head>
<body>
  <header>
    <h2>⡧⢼⢠⣲⢰⠒⢠⣺⠸⡸⡸⢠⣲⢸⢸⠰⣝⠐⣗</h2>
    <button>Connect HW</button>
  </header>
  <main>
    </br>
    <p>Make your own</p>
    </br>
    <h1>⡧⢼⢠⣲⢰⠒⢠⣺⠸⡸⡸⢠⣲⢸⢸⠰⣝⠐⣗</h1>
    </br>
    </br>
    <div>~ OpenSource & OpenHardWare & Self-custodial ~</div>
    </br>
    </br>
    </br>
    ─────────────────────────
    </br>
    </br>
    </br>
    <div>░▒▓ Get the hardware ▓▒░</div>
    </br>
    ■ text
    </br>
    text
    </br>
    text
    </br>
    </br>
    </br>
    <div>░▒▓ Flash the hardware ▓▒░</div>
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    </br>
    </br>
    <div>░▒▓ Connect & use ▓▒░</div>
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
    text
    </br>
  </main>
  <footer>
    <a href="#">GitHub ★0</a>
  </footer>

  <style>
    * { box-sizing: border-box; color: #c8e7cd; font-size: 16px; text-shadow: -1px 1px 3px #2cb16e; }
    html, body { margin: 0; padding: 0; }
    body {
      background: #080a02;
      text-align: center;
      font-family: monospace;
    }
    h1, h2, h3 {
      letter-spacing: -0.2em;
      font-family: monospace;
    }
    button {
      display: block;
      margin-left: auto;
      appearance: none;
      cursor: pointer;
      background: #c8e7cd22;
      border: 2px solid currentColor;
      border-radius: 4px;
      padding: 0.5em;
      font-family: monospace;
      box-shadow: -1px 1px 3px #2cb16e;
    }
    button,
    a {
      transition: all 0.2s ease;
    }
    button:hover,
    a:hover {
      filter: brightness(1.3);
    }
    button:active,
    a:active {
      filter: brightness(0.85);
    }
    header {
      position: sticky;
      top: 0;
    }
    header, footer {
      width: 100%;
      left: 0;
      padding: 1em;
      background: #121c;
      backdrop-filter: blur(1px);
    }
    main {
      padding: 1em 1em 5em;
    }
    footer {
      position: fixed;
      bottom: 0;
    }
    header h2 {
      float: left;
    }
  </style>

  <script>
    if (!("serial" in navigator)) {
      alert("No serial support")
    }

    // document.querySelector('button').addEventListener('click', async () => {
    (async () => {
      const ports = await navigator.serial.getPorts()
      console.log('ports', ports)

      let port

      if (!ports.length) {
        console.warn("No ports")
        return
      } else if (ports.length === 1) {
        port = ports[0]
      } else {
        const filters = [
          { usbVendorId: 0x2341, usbProductId: 0x0043 },
          { usbVendorId: 0x2341, usbProductId: 0x0001 }
        ];
        port = await navigator.serial.requestPort({ filters });
      }

      await port.open({ baudRate: 115200 })

      const { usbVendorId, usbProductId } = port.getInfo();
      console.log(usbVendorId, usbProductId)

      while (port.readable) {
        const textDecoder = new TextDecoderStream();
        const readableStreamClosed = port.readable.pipeTo(textDecoder.writable);
        const reader = textDecoder.readable.getReader();

        try {
          while (true) {
            const { value, done } = await reader.read();
            if (done) {
              reader.releaseLock();
              break;
            }
            console.log(value); // Uint8Array
          }
        } catch (err) {
          console.error(err)
        }
      }
    })()
    // });

    const font = {
      A: [
        ' # ',
        '# #',
        '###',
        '# #',
      ],
      B: [
        '## ',
        '## ',
        '# #',
        '###',
      ],
      C: [
        ' ##',
        '#  ',
        '#  ',
        ' ##',
      ],
      D: [
        '## ',
        '# #',
        '# #',
        '## ',
      ],
      E: [
        '###',
        '#  ',
        '## ',
        '###',
      ],
      F: [
        '###',
        '#  ',
        '## ',
        '#  ',
      ],
      G: [
        ' ##',
        '#  ',
        '# #',
        ' ##',
      ],
      H: [
        '#  #',
        '#  #',
        '####',
        '#  #',
      ],
      I: [
        '###',
        ' # ',
        ' # ',
        '###',
      ],
      J: [
        ' ##',
        '  #',
        '  #',
        '## ',
      ],
      K: [
        '# #',
        '## ',
        '# #',
        '# #',
      ],
      L: [
        '#  ',
        '#  ',
        '#  ',
        '###',
      ],
      M: [
        ' # # ',
        ' # # ',
        '# # #',
        '# # #',
      ],
      N: [
        '#  #',
        '## #',
        '# ##',
        '#  #',
      ],
      O: [
        ' # ',
        '# #',
        '# #',
        ' # ',
      ],
      P: [
        '## ',
        '# #',
        '## ',
        '#  ',
      ],
      Q: [
        '###',
        '# #',
        '###',
        '  #',
      ],
      R: [
        '## ',
        '# #',
        '## ',
        '# #',
      ],
      S: [
        ' ##',
        '#  ',
        '  #',
        '## ',
      ],
      T: [
        '###',
        ' # ',
        ' # ',
        ' # ',
      ],
      U: [
        '#  #',
        '#  #',
        '#  #',
        ' ###',
      ],
      V: [
        '# #',
        '# #',
        '# #',
        ' # ',
      ],
      W: [
        '# # #',
        '# # #',
        ' # # ',
        ' # # ',
      ],
      X: [
        '# #',
        ' # ',
        ' # ',
        '# #',
      ],
      Y: [
        '# #',
        '# #',
        ' # ',
        ' # ',
      ],
      Z: [
        '###',
        '  #',
        ' # ',
        '###',
      ],
      a: [
        '   ',
        ' ##',
        '# #',
        '###',
      ],
      b: [
        '#  ',
        '## ',
        '# #',
        '###',
      ],
      c: [
        '   ',
        ' ##',
        '#  ',
        ' ##',
      ],
      d: [
        '  #',
        ' ##',
        '# #',
        '###',
      ],
      e: [
        ' ##',
        '# #',
        '## ',
        ' ##',
      ],
      f: [
        ' ##',
        '#  ',
        '## ',
        '#  ',
      ],
      g: [
        ' ##',
        '# #',
        ' ##',
        '###',
      ],
      h: [
        '#  ',
        '## ',
        '# #',
        '# #',
      ],
      i: [
        '#',
        ' ',
        '#',
        '#',
      ],
      j: [
        ' #',
        '  ',
        ' #',
        '# ',
      ],
      k: [
        '#  ',
        '# #',
        '## ',
        '# #',
      ],
      l: [
        '#',
        '#',
        '#',
        '#',
      ],
      m: [
        '     ',
        '## # ',
        '# # #',
        '# # #',
      ],
      n: [
        '   ',
        '## ',
        '# #',
        '# #',
      ],
      o: [
        '   ',
        ' # ',
        '# #',
        ' # ',
      ],
      p: [
        '  ',
        '###',
        '###',
        '# ',
      ],
      q: [
        ' # ',
        '# #',
        ' ##',
        '  #',
      ],
      r: [
        '   ',
        '###',
        '#  ',
        '#  ',
      ],
      s: [
        ' #',
        '# ',
        ' #',
        '# ',
      ],
      t: [
        ' # ',
        '###',
        ' # ',
        ' ##',
      ],
      u: [
        '   ',
        '# #',
        '# #',
        '###',
      ],
      v: [
        '   ',
        '# #',
        '# #',
        ' # ',
      ],
      w: [
        '     ',
        '# # #',
        '# # #',
        ' # # ',
      ],
      x: [
        '   ',
        '# #',
        ' # ',
        '# #',
      ],
      y: [
        '   ',
        '# #',
        ' # ',
        ' # ',
      ],
      z: [
        '   ',
        '###',
        ' # ',
        '###',
      ],
      ' ': [
        '  ',
        '  ',
        '  ',
        '  ',
      ],
      '?': [
        ' ## ',
        '#  #',
        '  # ',
        '  # ',
      ],
      '!': [
        '#',
        '#',
        ' ',
        '#',
      ],
      '0': [
        '###',
        '# #',
        '# #',
        '###',
      ],
      '1': [
        ' #',
        '##',
        ' #',
        ' #',
      ],
      '2': [
        ' # ',
        '# #',
        ' # ',
        '###',
      ],
      '3': [
        '###',
        ' # ',
        '  #',
        '## ',
      ],
      '4': [
        '# #',
        '###',
        '  #',
        '  #',
      ],
      '5': [
        '###',
        '## ',
        '  #',
        '## ',
      ],
      '6': [
        ' ##',
        '## ',
        '# #',
        '###',
      ],
      '7': [
        '###',
        '  #',
        ' # ',
        ' # ',
      ],
      '8': [
        '###',
        '# #',
        '###',
        '###',
      ],
      '9': [
        '###',
        '###',
        '  #',
        '###',
      ],
      '(': [
        ' #',
        '# ',
        '# ',
        ' #',
      ],
      ')': [
        '# ',
        ' #',
        ' #',
        '# ',
      ],
      '.': [
        ' ',
        ' ',
        ' ',
        '#',
      ],
      ',': [
        ' ',
        ' ',
        '##',
        ' #',
      ],
      ',': [
        '  ',
        '  ',
        '##',
        ' #',
      ],
      '█': [
        '###',
        '###',
        '###',
        '###',
      ]
      /*
      A: [
        '',
        '',
        '',
        '',
      ],
      */
    }

    const makeFont = (text) => {
      const t = text.split('').map(char => font[char] || font[' ']).reduce((acc, fontedChar, i, arr) => {
        const space = i !== arr.length - 1 ? ' ' : ''
        acc[0] += fontedChar[0] + space
        acc[1] += fontedChar[1] + space
        acc[2] += fontedChar[2] + space
        acc[3] += fontedChar[3] + space
        return acc
      }, ['', '', '', ''])

      let result = ''
      for (let i = 0; i < t[0].length; i += 2) {
        let row1 = t[0].slice(i, i+2)
        let row2 = t[1].slice(i, i+2)
        let row3 = t[2].slice(i, i+2)
        let row4 = t[3].slice(i, i+2);
        let shift = [row1[0], row2[0], row3[0], row1[1], row2[1], row3[1], row4[0], row4[1]]
          .map(_ => _ == '#')
          .reduce((acc, current, i) => acc + (current ? 2 ** i : 0), 0)
        // U+2800 - U+28FF
        result += String.fromCharCode(0x2800 + shift)
      }
      return result
    }

    console.log(makeFont("Welcome to"))
    console.log(makeFont("HardWallet"))
  </script>
</body>
</html>